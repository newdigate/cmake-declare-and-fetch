cmake_minimum_required(VERSION 3.15)

include(FetchContent)
macro(DeclareAndFetch name giturl branch cmakeprefixes)
    FetchContent_Declare("${name}"
            GIT_REPOSITORY "${giturl}"
            GIT_TAG        "${branch}"
    )
    FetchContent_MakeAvailable("${name}")
    set("${name}_include" "${FETCHCONTENT_BASE_DIR}/${name}-src/src")
    include_directories("${${name}_include}")

    set (_my_list "${cmakeprefixes}")
    string (REPLACE " " ";" _my_list "${_my_list}")
    foreach (cmakeprefix IN LISTS _my_list)
        SET(CMAKE_PREFIX_PATH "${CMAKE_PREFIX_PATH}${FETCHCONTENT_BASE_DIR}/${name}-src/${cmakeprefix};")
    endforeach()

endmacro()